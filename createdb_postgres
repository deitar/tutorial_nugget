
# library for connecting to the Postgres database
import psycopg2
import psycopg2.extras

# build the postgres database connection string
db_username = 'postgres'
db_password = '1234'
db_host = 'localhost'
db_name = 'postgres'
db_port = 5432
db_uri = f"postgres://{db_username}:{db_password}@{db_host}:{db_port}/{db_name}"
conn = psycopg2.connect(db_uri)

# Open a cursor to perform database operations
cur = conn.cursor()
create_table_query = "CREATE TABLE copy_command_test (fname varchar, lname varchar);"
cur.execute(create_table_query)


# set the path to your csv file
file_path = '<file_path>'
copy_table_query = "COPY copy_command_test FROM '{file_path}' WITH (FORMAT csv);"
cur.execute(copy_table_query)


copy_table_query = "COPY copy_command_test FROM STDIN WITH (FORMAT csv);"
f = StringIO('''fname,lname\ndebo,shola\nmope,tunji''')
cur.copy_expert(copy_table_query, f)




